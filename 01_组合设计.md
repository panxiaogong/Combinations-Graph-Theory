## 区组设计
&emsp;&emsp;一个所谓的**区组设计**(Block design)，是指序对 $(X,\mathcal{A})$ ，满足：
- $X$ 是一个有限集，其中的元素称为“点”
- $\mathcal{A}$ 是一个由 $X$ 的子集组成的集合，每一个子集称为“区组”。

&emsp;&emsp;比如由 $X=\\{A,B,C,D\\}$ ， $\mathcal{A}=\\{\\{A,B,C,D\\},\\{A,C,D\\},\\{A,C\\},\\{B,D\\}\\}$ 构成的序对 $(X,\mathcal{A})$ ，就是一个区组设计。另外，如果 $\mathcal{A}$ 中不包含重复的元素，那么就称其为**简单设计**，相比于有重复区组，我们更喜欢研究无重复区组的设计，也就是简单设计。

&emsp;&emsp;下面我们来看一种特殊的区组设计：平衡不完全区组设计(balanced incomplete block design)。

&emsp;&emsp;设 $v,k,\lambda$ 为正整数，满足 $v>k\geqslant 2$ 。一个 $(v,k,\lambda)$ 平衡不完全区组设计，简记为 $(v,k,\lambda)-BIBD$ ，是一个满足下述性质的区组设计：
- $|X|=v$ 。
- 每个区组恰好包含 $k$ 个点。
- 任意两个点恰好同时出现在 $\lambda$ 个区组中。

&emsp;&emsp;比如，将 $\mathcal{A}$ 取为 $X$ 的所有 $k$ 元子集，那任意的两个点同时出现在了多少个区组中呢？只需要考虑区组中剩余的 $k-2$ 个位置有多少种选法，就是 $\binom{v-2}{k-2}$ ，那么此时序对 $(X,\mathcal{A})$ 就是一个 $(v,k,\binom{v-2}{k-2})-BIBD$ 。下面我们来看几个十分著名的BIBD例子。

### (7,3,1)-BIBD

&emsp;&emsp;在该BIBD中：
- $X=\\{1,2,3,4,5,6,7\\}$
- $\mathcal{A}=\\{123,145,167,246,257,347,356\\}$   
  神奇的是，该BIBD对应着一个名叫Fano平面的图形，如下：
  
<p align="center">
<img src="https://github.com/user-attachments/assets/9a3501a2-ac28-4500-9a69-1cc60257279b" width="250" />

&emsp;&emsp;你会发现，每一个区组所对应的三个点是“共线的”（我不知道有没有这个专业术语），比如说123，145，比较特殊的则是257，三个点在同一个圆上，而且，如果我们将这7个点用二进制形式表示：1=(0,0,1)，2=(0,1,0)，3=(0,1,1)，4=(1,0,0)，5=(1,0,1)，6=(1,1,0)，7=(1,1,1)，那么三个点构成一个区组的充要条件是 $x+y=z$ ，就拿区组123举例，显然有：(0,0,1)+(0,1,0)=(0,1,1)。

### (9,3,1)-BIBD

&emsp;&emsp;在该BIBD中：
- $X=\\{1,2,3,4,5,6,7,8,9\\}$
- $\mathcal{A}=\\{123,456,789,147,258,369,159,267,348,357,168,249\\}$
  那该如何书写这个BIBD呢？你只需要一个九宫格：
  


&emsp;&emsp;这12个区组，对应着该九宫格的行、列、主对角线方向以及副对角线方向。

&emsp;&emsp;那是否还存在其他的 $(x,3,1)-BIBD$ 呢？我们下面来讨论一下BIBD形成的必要条件。

&emsp;&emsp;我们引入另外两个参数， $b$ 与 $r$ ，其中， $b$ 是区组的数目，也就是集合 $\mathcal{A}$ 的元素个数， 而 $r$ 是指每个元素在各区组中出现的总次数，那就会有一些限制：
- 我们考虑任意一个元素在这些区组里总共会碰到多少次其他的元素：一个元素总共出现 $r$ 次，也就是出现在 $r$ 个 $k$ 元集合，在每个集合里它会遇到 $k-1$ 个其他的元素，那么一共碰到了 $r(k-1)$ 次，由BIBD的定义，任意两个元素都会碰见 $\lambda$ 次，所以该元素同剩下的 $v-1$ 个元素中的每一个都会碰见 $\lambda$ 次，所以有 $r(k-1)=\lambda(v-1)$ 。（双计数证明）
- 我们考虑这些元素一共出现了多少次：总共有 $b$ 个区组，每个区组有 $k$ 个元素，所以这些元素一共出现了 $bk$ 次，另一方面，由于每个元素都要出现 $r$ 次，总共有 $v$ 个元素，所以一共出现了 $vr$ 次，所以有 $bk=vr$ 。

&emsp;&emsp;综上，我们有：

$$\begin{align\*}
r=\frac{\lambda(v-1)}{k-1}\\
b=\frac{vr}{k}=\frac{\lambda v(v-1)}{k(k-1)}\\
\end{align\*}$$

&emsp;&emsp;实际上，之所以我们在简记BIBD时省略 $b,r$ 这两个参数，也是因为这两个参数可以通过另外三个参数算出来，所以省略不写。另外，由于 $b,r$ 必须是整数，所以参数之间必须要有如下的整除关系：

$$\begin{align\*}
k-1|\lambda(v-1),k(k-1)|\lambda v(v-1)
\end{align\*}$$

&emsp;&emsp;补充：关于 $(v,3,1)-BIBD$ (又称为Steiner三元系)，它存在的充要条件是 $v\equiv1,3(mod\\;6)$ ，另外，由于上述条件是必要条件，有些参数确实符合，但却没有对应的BIBD，比如 $(19,4,1)-BIBD,(22,8,4)-BIBD$ 实际上是不存在的。

&emsp;&emsp;下面来看一个基于区组设计的具体问题：

&emsp;&emsp;我们有一个一次写入存储器和七条信息，每个比特位的初始状态为0，信息写入的过程只允许将0修改为1，不允许将1修改为0，现在想连续使用该存储器4次，传递七条信息中的四条(可能信息会重复出现)，每次传输一条，请问至少需要多少比特位？

&emsp;&emsp;解：显然，如果我们使用12位比特位，分为四组，每次使用三位，用二进制数表示信息的编号，这是可行的，但是如果我们基于Fano平面，我们只需要7个比特位，就能传输完这四条信息(听上去有些奇怪对吧，你可能会想为什么不传递第几条信息就把第几个位置的比特位变为1呢？比如我要传输1212，前两次还可以正常传递，但是第三次时由于比特位不能从1变0，所以此方法行不通)。下面我们来详细介绍一下借助Fano平面的传输规则(注意，若新的轮次存储与上一轮同样的信息，则无需操作)：
- 第一次传输：传递信息 $i$ 则将第 $i$ 个位置改为1
- 第二次传输：传递信息 $j$ 则将第 $p$ 个位置改为1，使得 $ijp$ 构成区组
- 第三次传输：存储信息 $k$ 则再将两个位置改为1，使得当前4个为1的位置包含一个区组及第 $k$ 个位置。
- 第四次传输：若存储的信息 $l$ 是 $i$  $j$  $p$ 中的某一个，那么将第 $q$ 个位置改为1，使得 $klq$ 形成区组，这样两区组重复的元素就是我们要传递的信息，若存储的信息 $l$ 不是 $i$  $j$  $p$ 中的任意一个，那么将除了第 $l$ 个比特位的其他位置均改为1，使得第 $l$ 个比特位是唯一一个为0的比特位，这就是我们要传输的信息。

&emsp;&emsp;我们举个具体的例子：第一次想传输信息1，那么就将Fano平面上的第1个位置改为1；第二次想传输信息2，那么就将第3个位置改为1，使得123构成区组；第三次想传输信息4，那么就将第2、4个位置改为1，此时123构成区组，4作为区组外的唯一位置，第四次想传输的信息如果是1、2、3中的某一个，比如说2，那么就将第6个位置改为1，使得图上有区组123和246，如果不是1、2、3中的任意一个，比如说7，那么就将第5、6位置改为1，只有第7个位置是0，达到了传输信息的效果。

### 关联矩阵

&emsp;&emsp;设 $(X,\mathcal{A})$ 为一个区组设计，其中 $X=\\{x_1,x_2,...,x_v\\},\mathcal{A}=\\{A_1,...,A_b\\}$ ，此设计的关联矩阵是一个大小为 $v\times b$ 的二元矩阵 $M=(m_{i,j})$ ，其中：

$$\begin{align\*}
m_{i,j}=\begin{cases}
1\\;\\;x_i\in A_j\\
0\\;\\;x_i\notin A_j\\
\end{cases}
\end{align\*}$$

&emsp;&emsp;我们拿(9,3,1)-BIBD举例，它的关联矩阵长下面这样(为了方便理解这里写成表格的形式，但实际上写成矩阵是不需要第一行与第一列来进行标注的)：

|      | 123  | 456  | 789  | 147  | 258  | 369  | 159  | 267  | 348  | 168  | 249  | 357  |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 1    | 1    | 0    | 0    | 1    | 0    | 0    | 1    | 0    | 0    | 1    | 0    | 0    |
| 2    | 1    | 0    | 0    | 0    | 1    | 0    | 0    | 1    | 0    | 0    | 1    | 0    |
| 3    | 1    | 0    | 0    | 0    | 0    | 1    | 0    | 0    | 1    | 0    | 0    | 1    |
| 4    | 0    | 1    | 0    | 1    | 0    | 0    | 0    | 0    | 1    | 0    | 1    | 0    |
| 5    | 0    | 1    | 0    | 0    | 1    | 0    | 1    | 0    | 0    | 0    | 0    | 1    |
| 6    | 0    | 1    | 0    | 0    | 0    | 1    | 0    | 1    | 0    | 1    | 0    | 0    |
| 7    | 0    | 0    | 1    | 1    | 0    | 0    | 0    | 1    | 0    | 0    | 0    | 1    |
| 8    | 0    | 0    | 1    | 0    | 1    | 0    | 0    | 0    | 1    | 1    | 0    | 0    |
| 9    | 0    | 0    | 1    | 0    | 0    | 1    | 1    | 0    | 0    | 0    | 1    | 0    |

&emsp;&emsp;结合例子以及定义：
- 每一列的重量(1的数目)为 $k$ ，也就是区组的大小。
- 每一行的重量为 $r$ ，也就是每个点出现的次数
- 任意两行恰好在 $\lambda$ 列上同时取1(因为任意两对元素会同时出现在 $\lambda$ 个区组里)

&emsp;&emsp;符号说明：
- 记 $I_n$ 为 $n$ 阶单位矩阵
- 记 $J_n$ 为 $n$ 阶全一矩阵
- 记 $u_n$ 为 $n$ 长的全一行向量   
我们有下面的定理：

&emsp;&emsp;**定理**：令 $M$ 为一个大小为 $v\times b$ 的二元矩阵，其中 $2\leqslant k<v$ ，则 $M$ 是一个 $(v,b,r,k,\lambda)-BIBD$ 的关联矩阵当且仅当：

$$\begin{align\*}
MM^T=\lambda J_v+(r-\lambda)I_v,\\;\\;and\\;u_vM=ku_b
\end{align\*}$$

&emsp;&emsp;**证明**：若 $M$ 是一个 $(v,b,r,k,\lambda)-BIBD$ 的关联矩阵：对于矩阵 $MM^T$ 中的元素 $a_ij$ 当 $i\neq j$ 时，意味着 $M$ 中的第 $i$ 行乘以 $M^T$ 中的第 $j$ 列，也就是第 $i$ 个元素和第 $j$ 个元素同时出现在了多少个区组中，由定义我们知道，任意两对元素同时出现在 $\lambda$ 个区组中，所以 $a_ij=\lambda(i\neq j)$ ；当 $i= j$ 时，意味着计数第 $i$ 个元素在全部区组中总共出现了多少次，由定义可知是 $r$ 次，所以 $a_ij=r(i= j)$ ，所以 $MM^T$ 就是一个除主对角线上元素全为 $r$ ，其余位置元素全为 $\lambda$ 的矩阵，自然可以写成：

$$\begin{align\*}
MM^T=\lambda J_v+(r-\lambda)I_v
\end{align\*}$$

&emsp;&emsp;至于 $u_vM=ku_b$ ，这相当于计数每个区组中出现了多少个元素，显然成立。

## 对偶设计

&emsp;&emsp;若区组设计 $(X,\mathcal{A})$ 的关联矩阵为 $M$ ，而存在一个区组设计 $(Y,\mathcal{B})$ 的关联矩阵为 $M^T$ ，则称 $(Y,\mathcal{B})$ 为 $(X,\mathcal{A})$ 的**对偶设计**(dual design)。不难看出，有：
- $|Y|=|\mathcal{A}|,\\;\\;|\mathcal{B}|=|X|$ 

&emsp;&emsp;**定理**：如果 $(X,\mathcal{A})$ 是 $(v,b,r,k,\lambda)-BIBD$ ，则它的对偶设计 $(Y, \mathcal{B})$ 有如下性质：
- $\mathcal{B}$ 中的每个区组大小为 $r$   
  $\mathcal{B}$ 来源于原来的 $X$ ，原来 $X$ 中的每个点出现在 $\mathcal{A}$ 的 $r$ 个区组中，现在将 $\mathcal{A}$ 中的区组作为 $Y$ 中的元素， $X$ 中的点作为 $\mathcal{B}$ 中的区组， $\mathcal{B}$ 中区组的含义就是原来 $\mathcal{A}$ 中有多少个区组出现了这个点，所以是 $r$ 。
- $Y$ 的每个点恰好出现在 $k$ 个区组中   
  $Y$ 来源于原来的 $\mathcal{A}$ ，由于 $\mathcal{A}$ 中的元素都是 $k$ 元子集，也就是出现了 $X$ 中的 $k$ 点，那么 $\mathcal{B}$ 中应该有 $k$ 个区组含有 $Y$ 中的该点，所以是 $k$ 
- 任意两个区组恰好交于 $\lambda$ 个点
  在 $(X,\mathcal{A})$ 中，任意两对元素会同时出现在 $\lambda$ 个区组中，而如果将区组作为点，元素作为区组，那么每个区组就会有 $\lambda$ 个点重合。

&emsp;&emsp;其实写到这里我也不明白，所以拿 $(9,3,1)-BIBD$ 举例： $X=\\{1,2,3,4,5,6,7,8,9\\}$ ，所以 $\mathcal{A}$ 包含下列区组：

$$\begin{align\*}
B=\\{1,2,3\\}\\;\\;C=\\{4,5,6\\}\\;\\;D=\\{7,8,9\\}\\
E=\\{1,4,7\\}\\;\\;F=\\{2,5,8\\}\\;\\;G=\\{3,6,9\\}\\
H=\\{1,5,9\\}\\;\\;I=\\{2,6,7\\}\\;\\;J=\\{3,4,8\\}\\
K=\\{1,6,8\\}\\;\\;L=\\{2,4,9\\}\\;\\;M=\\{3,5,7\\}\\
\end{align\*}$$

&emsp;&emsp;所以其对偶设计的点集为 $Y=\\{B,C,D,E,F,G,H,I,J,K,L,M\\}$ ， $\mathcal{B}$ 包含以下区组：

$$\begin{align\*}
S_1=\\{B,E,H,K\\}\\;\\;S_2=\\{B,F,I,L\\}\\;\\;S_3=\\{B,G,J,M\\}\\
S_4=\\{C,E,J,L\\}\\;\\;S_5=\\{C,F,H,M\\}\\;\\;S_6=\\{C,G,I,K\\}\\
S_7=\\{D,E,I,M\\}\\;\\;S_8=\\{D,F,J,K\\}\\;\\;S_9=\\{D,G,H,L\\}\\
\end{align\*}$$

## 由已知BIBD得到新的BIBD

&emsp;&emsp;**定理(Sum construction)**：若存在 $(v,k,\lambda_1)-BIBD$ 和 $(v,k,\lambda_2)-BIBD$ ，则存在 $(v,k,\lambda_1+\lambda_2)-BIBD$ 。
- 例：由 $(16,6,2)-BIBD$ 和 $(16,6,3)-BIBD$ 就可得到任意的 $(16,6,\lambda)-BIBD,\lambda\geqslant2$
-  $(v,k,\lambda)-BIBD\Leftarrow(v,k,s\lambda)-BIBD$
-  这样构造的BIBD可能不是简单设计。一般来说，构造简单BIBD要比构造允许带重复区组的BIBD更难。

&emsp;&emsp;**定理(Block complementation)**：若存在 $(v,b,r,k,\lambda)-BIBD$ ，其中 $k\leqslant v-2$ ，则存在 $(v,b,b-r,v-k,b-2r+\lambda)-BIBD$ 。
- $(X,{X\setminus A,A\in\mathcal{A} })$ ， $v$ 个点， $b$ 个区组，区组大小为 $v-k\geqslant 2$
  其实就是把每个区组变为其原本不含有的元素的区组
- 每个点出现在恰好 $b-r$ 个区组中
- 任意两点同时出现在 $b-2r+\lambda$ 个区组中   
  对于任意两个元素 $x,y$ ，其分别出现在 $r$ 个区组中，同时出现在 $\lambda$ 个区组中，一共有 $2r-\lambda$ 个区组有 $x$ 或 $y$ ，那么进行补设计之后就有 $b-2r+\lambda$ 个区组中同时含有 $x,y$ 。
- 也正是因为补设计的存在，所以在讨论BIBD的存在性与构造性时，我们只需要考虑 $k\leqslant v/2$ 的情形

## 对称设计
































